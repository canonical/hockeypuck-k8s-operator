# Copyright 2025 Canonical Ltd.
# See LICENSE file for licensing details.

type: charm
name: hockeypuck-k8s
title: Hockeypuck K8S Charm
summary: Hockeypuck OpenPGP public keyserver
links:
  documentation: https://discourse.charmhub.io/t/hockeypuck-documentation-overview/16591
  issues: https://github.com/canonical/hockeypuck-k8s-operator/issues
  source: https://github.com/canonical/hockeypuck-k8s-operator
  contact: https://launchpad.net/~canonical-is-devops

description: |
  A [Juju](https://juju.is/) [charm](https://juju.is/docs/olm/charmed-operators)
  for deploying and managing [Hockeypuck](https://hockeypuck.io/) on Kubernetes. Hockeypuck is an
  OpenPGP public keyserver tool used to manage public key infrastructure for PGP 
  (Pretty Good Privacy). PGP is a system for securing communication through encryption and 
  digital signatures.

  The server provides interfaces to add, look up, replace and delete public keys from the 
  keyserver. Hockeypuck can synchronize public key material with SKS (Synchronizing Key Server) 
  and other Hockeypuck servers. It implements the HTTP Keyserver Protocol and the SKS database 
  reconciliation protocol.

  For DevOps and SRE teams, this charm will make operating Hockeypuck simple and straightforward
  through Juju's clean interface.

extensions:
  - go-framework

assumes:
  - juju >= 3.4
  - k8s-api

containers:
  hockeypuck:
    resource: hockeypuck-image

resources:
  hockeypuck-image:
    type: oci-image
    description: OCI image for Hockeypuck

requires:
  postgresql:
    interface: postgresql_client
    optional: false
    limit: 1

config:
  options:
    external-peers:
      type: string
      description: Comma-seperated list of external peer IPs or FQDNs

base: ubuntu@24.04
build-base: ubuntu@24.04
platforms:
  amd64:
